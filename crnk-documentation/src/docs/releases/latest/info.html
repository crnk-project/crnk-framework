With this release the first version of Crnk 3.x is released. There are many new, incremental
improvements and cleanups. The cleanup can cause minor API breaks due to deprecations being
removed and repositories losing the historic V2 suffix. The release is labelled as BETA because
further cleanup and changes are expected. Otherwise the release builds upon previous releases
and should be a drama-free upgrade.


<h4>ResourceRepository instead of ResourceRepositoryV2</h4>

The V2 suffixes have been removed from the repository interfaces. They have been in place for historic reasons
to follow the former QueryParams-based repositories. QueryParams continue to be supported, but the repository
now carry a &quot;Legacy&quot; prefix.


<h4>Experimental Annotation Processor for type-safe QuerySpec construction</h4>

An annotation processor is introduced that generates type-safe QuerySpec and PathSpec subtypes for their
type-safe construction:

<pre class="prettyprint">
UserQuerySpec querySpec = new UserQuerySpec();
        querySpec.sort().loginId().desc();
        querySpec.filter().projects().id().filter(FilterOperator.EQ, 12);
        querySpec.field().loginId();
        querySpec.include().projects();
</pre>

More information can be found <a href="www.crnk.io/releases/latest/documentation/#_generation_java">here</a>.


<h4>Refactored Gradle generator plugin</h4>

The Gradle Typescript generator has been refactored to support the generator of artifacts other than Typescript.
For this purpose the project has been split into `crnk-gen-gradle`, `crnk-gen-typescript` and a number of
helper projects. The new setup looks like:

<pre class="prettyprint">
buildscript {
	dependencies {
		classpath "io.crnk:crnk-gen-gradle:${version}"
	}
}

apply plugin: 'crnk-gen'
crnkGen {
    runtime {
        configuration = 'typescriptGenRuntime'
    }

    forked = true
    resourcePackages = ['ch.adnovum.sb4b.management.api', 'ch.adnovum.sb4b.identity.api', 'ch.adnovum.sb4b.corda.base.contract']

    typescript {
        enabled = true
        format = 'PLAINJSON'
        genDir = file('src/resources')
    }
}
</pre>

More information about Typescript generation is available
<a href="documentation/#_typescript">here</a>.

<h4>More flexible EntityManager setup with JPA module</h4>

JpaModule.createServerModule(...) comes with a new flavor that allows to pass the EntityManager
as java.util.Supplier. Every time a repository makes use of the EntityManager, the supplier is called and must
return an instance. The supplier together with the existing TransactionRunner
allows for custom JPA setups and transaction handling.

<h4>Allow QuerySpec conversion to Criteria query</h4>

The following code snipped shows how to convert a QuerySpec to Criteria query without involving repositories:

<pre class="prettyprint">
JpaCriteriaQueryFactory queryFactory = JpaCriteriaQueryFactory.newInstance(em);

PathSpec idAttr = PathSpec.of(TestEntity.ATTR_id);
QuerySpec querySpec = new QuerySpec(TestEntity.class);
querySpec.addFilter(idAttr.filter(FilterOperator.GT, 0L));
querySpec.addSort(idAttr.sort(Direction.DESC));
querySpec.includeField(PathSpec.of("oneRelatedValue"));

JpaCriteriaQuery&lt;TestEntity&gt; query = queryFactory.query(TestEntity.class);
JpaQueryExecutor&lt;TestEntity&gt; executor = query.buildExecutor(querySpec);
List&lt;TestEntity&gt; resultList = executor.getResultList();
</pre>



<h4>InMemoryHttpAdapter to connect CrnkClient with a server</h4>

There is a new InMemoryHttpAdapter implementation completing OkHttp, Apache HTTP client and RestTemplate.
InMemoryHttpAdapter takes a CrnkBoot instance as parameter to directly connecting to a server without
having to go through any TCP/HTTP transport layer. Requests are still serialized and deserialized, but
no running HTTP server is necessary. Unit testing can greatly benefit from such a more simpler
and faster setup:

<pre class="prettyprint">
    String url = ...
    CrnkClient client = new CnrkClient(url).
    client.setHttpAdapter(new InMemoryHttpAdapter(crnkBoot, url));
</pre>



<h4>HttpAdapterListener for a vendor-neutral HTTP request/response interception</h4>

A new HttpAdapterListener can be added with addListener to HttpAdapter. It allows to cover many of the typical
use cases like adding security headers without having to get and customize the underlying HTTP implementation.


<h4>crnk-format-plain-json in CrnkClient</h4>

The PlainJsonFormatModule can now be added to CrnkClient. This is in particular useful together with
the Asciidoc generator to create documentation in the plain json format for consumer making use of it.


<h4>Prettier URLs computation</h4>

Computed links (CrnkClient, pagination, etc.) by default omit the `EQ` operator and type information where
not necessary. This leads to more readable URLs like:

<pre class="prettyprint">
    http://127.0.0.1/api/tasks?filter[name]=Doe
</pre>

rather than

<pre class="prettyprint">
    http://127.0.0.1/api/tasks?filter[tasks][name][EQ]=Doe
</pre>



<h4>OpenTracing Support</h4>

OpenTracing is a vendor-neutral API to write trace information. crnk-monitor-opentracing introduces a new module OpenTracingServerModule
that brings support for OpenTracing to Crnk. It can be used properly set the names of spans. More information is available
in the documentation.


<h4>Singular Nested Resources</h4>

Support for nested resources has been improved by introducing support singular nested resources. Thereby a parent can hold a single nested resource as
single-valued relationships. Urls then look like:

<p>
    http://example.com/posts/1/header
</p>


<p>An example looks like:

<pre class="prettyprint">
@JsonApiResource(type = "header", nested = true)
public class PostHeader {

	@JsonApiId
	@JsonApiRelationId
	private String postId;

	private String value;

	@JsonApiRelation(opposite = "header", lookUp = LookupIncludeBehavior.AUTOMATICALLY_WHEN_NULL,
			repositoryBehavior = RelationshipRepositoryBehavior.FORWARD_OWNER)
	private Post post;

	...
}
</pre>

More information can be found <a href="documentation/#_nested_resources">here</a>.


<h4>Enum support for Activiti</h4>

crnk-jpa maps Enum types to Strings for Activiti. This to by-pass the regular Activiti serialization mechanism that
treats the enum like a java.lang.Object by storing it is as serialized blob and not supporting filtering.
